@page "/"
@using MKOpenAIDemo
@using MKOpenAIDemo.Components;
@inject ILogger<Home> Logger

<h3>Chat with AI</h3>

<ChatComponent ChatBotInstance="ChatBotInstance">
<div class="chat-container">
    <div class="chat-history">
        @foreach (var message in ChatBotInstance.ChatMessages.ChatHistory)
        {
            <div class="chat-message">
                <strong>@message.Role:</strong> @message.Content
            </div>
        }
    </div>

    

    <div class="chat-input">
        <textarea @bind="UserInput" placeholder="Type your message here..." rows="3"></textarea>
        <button @onclick="SendMessage">Send</button>
            <button @onclick="ChatBotInstance.SendMessage">test</button>
    </div>
</div>
</ChatComponent>
<button onclick="alert()">Send</button>

@code {
    private ChatBot ChatBotInstance = new ChatBot();
    private string UserInput = string.Empty;

    private void TestClick()
    {
        Logger.LogInformation("Button clicked!");
    }

    private async Task SendMessage()
    {
        try
        {
            ChatBotInstance.UserInput = UserInput;
            await ChatBotInstance.SendMessage();
        }
        catch (Exception ex)
        {
            Logger.LogError(ex, "Error while sending message.");
        }
    }
}
